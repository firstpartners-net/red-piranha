<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (13.0.2) on Sat May 16 22:24:26 IST 2020 -->
<title>CSVOutputStrategy (Red Piranha - Power Tools for Excel and Office Users)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2020-05-16">
<meta name="description" content="declaration: package: net.firstpartners.core.file, class: CSVOutputStrategy">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSVOutputStrategy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">net.firstpartners.core.file</a></div>
<h1 title="Class CSVOutputStrategy" class="title">Class CSVOutputStrategy</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree">java.lang.Object
<div class="inheritance">net.firstpartners.core.file.CSVOutputStrategy</div>
</div>
<section class="description">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">CSVOutputStrategy</span>
extends java.lang.Object
implements <a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></pre>
<div class="block">Strategy class of output of CSV Document.
 <p>
 CSV will try to append to an existing CSV file. In general, one document
 processed equals one line in the CSV file.
 
 The table below might help understand this Outputers behaviour.
 <table style="border: 1px solid black;">
 <tr>
 <td>heading-1</td>
 <td>heading-2</td>
 <td>heading-3</td>
 </tr>
 <tr>
 <td>file-a-cell1.value&nbsp;</td>
 <td>file-a-cell2.value&nbsp;</td>
 <td>file-a-cell3.value&nbsp;</td>
 </tr>
 <td>file-b-cell1.value&nbsp;</td>
 <td>file-b-cell2.value&nbsp;</td>
 <td>file-b-cell3.value&nbsp;</td>
 </tr>
 </table>
 <p>
 The process by which the Outputer works is as follows. It uses the data from
 the RangeHolder (our version of the Word / Excel / Other document that was
 passed in, that the rules then modified).
 </p>
 <p>
 Happily, this data is displayed in the Red Piranha GUI - picture below - so
 you can see the data you have to work with.
 </p>
 <ol>
 <li>The Outputer looks for a csv file of the name given (normally in the
 config file); if it does not find it will throw an error.</li>
 <li>The Outputer will take the headers (the first line of the CSV file). In
 the above example it will be heading-1, heading-2 and heading-3.</li>
 <li>For each of these header values, the outputer will search for a @see Cell
 of the same cellName from the RangeHolder data.</li>
 <li>If it finds a match, it will take the value of that Cell Object and use
 it when outputing the line.</li>
 <li>After it has tried to find matches, it will then add one line to the CSV
 file, using the values found.</li>
 </ol>
 <p>
 While the Outputer will not overwrite any data present, it will not check for
 duplicates; running this five times will add five lines of equal data. We
 leave it up to your Excel skills to detect duplicates!
 </p>
 <p>
 Some best practices should include
 </p>
 <ul>
 <li>Including a filename or some other unique identifier in the csv output
 file. That way you can spot and filter out any duplicate runs.</li>
 <li>In your rule file, map your incoming value to an specific outgoing value.
 That way your output name should not change if if there are changes to the
 format of the source document.</li>
 </ul>
 </p>
 <p>
 <img src=
 "https://paulbrowne-irl.github.io/red-piranha/images/GuiRangeHolder.png"
 alt="Red Piranha GUI showing RangeHolder Data></img>
 </p></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>paul</dd>
</dl>
</section>
<section class="summary">
<ul class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(java.lang.String)">CSVOutputStrategy</a></span>&#8203;(java.lang.String&nbsp;outputFileName)</code></th>
<td class="colLast">
<div class="block">Constructor - takes the name of the file we intend outputting to</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flush()">flush</a></span>()</code></th>
<td class="colLast">
<div class="block">Not needing to be implemented as part of this strategy</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flush(net.firstpartners.core.log.ILogger)">flush</a></span>&#8203;(<a href="../log/ILogger.html" title="interface in net.firstpartners.core.log">ILogger</a>&nbsp;logger)</code></th>
<td class="colLast">
<div class="block">We implement this is part of the interface, but don't do anything with it.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMatchingValues(java.util.List,net.firstpartners.data.RangeList)">getMatchingValues</a></span>&#8203;(java.util.List&lt;java.lang.String&gt;&nbsp;headers,
<a href="../../data/RangeList.html" title="class in net.firstpartners.data">RangeList</a>&nbsp;beanData)</code></th>
<td class="colLast">
<div class="block">/** Get the values from our Beans (RangeList) that match the headers</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getOutputDestination()">getOutputDestination</a></span>()</code></th>
<td class="colLast">
<div class="block">String representing where our output is going to</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getOutputFileName()">getOutputFileName</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processOutput()">processOutput</a></span>()</code></th>
<td class="colLast">
<div class="block">Process the output from the system</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setDocumentLogger(net.firstpartners.core.log.ILogger)">setDocumentLogger</a></span>&#8203;(<a href="../log/ILogger.html" title="interface in net.firstpartners.core.log">ILogger</a>&nbsp;userLogger)</code></th>
<td class="colLast">
<div class="block">Handle that we can pass informration back to the user</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setUpdates(net.firstpartners.core.file.OfficeDocument,net.firstpartners.data.RangeList)">setUpdates</a></span>&#8203;(<a href="OfficeDocument.html" title="class in net.firstpartners.core.file">OfficeDocument</a>&nbsp;ignored,
<a href="../../data/RangeList.html" title="class in net.firstpartners.data">RangeList</a>&nbsp;incomingData)</code></th>
<td class="colLast">
<div class="block">Update a copy of our Original Document with new data</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(java.lang.String)">CSVOutputStrategy</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">CSVOutputStrategy</span>&#8203;(<span class="arguments">java.lang.String&nbsp;outputFileName)</span></div>
<div class="block">Constructor - takes the name of the file we intend outputting to</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>outputFileName</code> - - file we want to output to</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="flush()">flush</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">flush</span>()</div>
<div class="block">Not needing to be implemented as part of this strategy</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../IDocumentOutStrategy.html#flush()">flush</a></code>&nbsp;in interface&nbsp;<code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="flush(net.firstpartners.core.log.ILogger)">flush</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">flush</span>&#8203;(<span class="arguments"><a href="../log/ILogger.html" title="interface in net.firstpartners.core.log">ILogger</a>&nbsp;logger)</span></div>
<div class="block">We implement this is part of the interface, but don't do anything with it.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../IDocumentOutStrategy.html#flush(net.firstpartners.core.log.ILogger)">flush</a></code>&nbsp;in interface&nbsp;<code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getMatchingValues(java.util.List,net.firstpartners.data.RangeList)">getMatchingValues</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</span>&nbsp;<span class="memberName">getMatchingValues</span>&#8203;(<span class="arguments">java.util.List&lt;java.lang.String&gt;&nbsp;headers,
<a href="../../data/RangeList.html" title="class in net.firstpartners.data">RangeList</a>&nbsp;beanData)</span></div>
<div class="block">/** Get the values from our Beans (RangeList) that match the headers</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>headers</code> - that we are looking to match in the data</dd>
<dd><code>beanData</code> - that we have collected.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Map <header-key, matching-value></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getOutputDestination()">getOutputDestination</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getOutputDestination</span>()</div>
<div class="block">String representing where our output is going to</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../IDocumentOutStrategy.html#getOutputDestination()">getOutputDestination</a></code>&nbsp;in interface&nbsp;<code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String - where we will output this to</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getOutputFileName()">getOutputFileName</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getOutputFileName</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="processOutput()">processOutput</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">processOutput</span>()
                   throws <span class="exceptions">java.io.IOException,
org.apache.poi.openxml4j.exceptions.InvalidFormatException</span></div>
<div class="block">Process the output from the system</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../IDocumentOutStrategy.html#processOutput()">processOutput</a></code>&nbsp;in interface&nbsp;<code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - - from underlying libs</dd>
<dd><code>org.apache.poi.openxml4j.exceptions.InvalidFormatException</code> - - from underlying libs</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setDocumentLogger(net.firstpartners.core.log.ILogger)">setDocumentLogger</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setDocumentLogger</span>&#8203;(<span class="arguments"><a href="../log/ILogger.html" title="interface in net.firstpartners.core.log">ILogger</a>&nbsp;userLogger)</span></div>
<div class="block">Handle that we can pass informration back to the user</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../IDocumentOutStrategy.html#setDocumentLogger(net.firstpartners.core.log.ILogger)">setDocumentLogger</a></code>&nbsp;in interface&nbsp;<code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userLogger</code> - - this strategy does not use</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setUpdates(net.firstpartners.core.file.OfficeDocument,net.firstpartners.data.RangeList)">setUpdates</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setUpdates</span>&#8203;(<span class="arguments"><a href="OfficeDocument.html" title="class in net.firstpartners.core.file">OfficeDocument</a>&nbsp;ignored,
<a href="../../data/RangeList.html" title="class in net.firstpartners.data">RangeList</a>&nbsp;incomingData)</span>
                throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Update a copy of our Original Document with new data</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../IDocumentOutStrategy.html#setUpdates(net.firstpartners.core.file.OfficeDocument,net.firstpartners.data.RangeList)">setUpdates</a></code>&nbsp;in interface&nbsp;<code><a href="../IDocumentOutStrategy.html" title="interface in net.firstpartners.core">IDocumentOutStrategy</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ignored</code> - - normally the original file, but this strategy ignores
                     it</dd>
<dd><code>incomingData</code> - - our Javabeans to output</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - fileToProcess</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSVOutputStrategy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>
			<i>FirstPartners.net 2010-2020.</i>
			</small></p>
</footer>
</body>
</html>
